# PDF论文处理与机构信息分析工具

这是一个功能完善的PDF文件批量处理与信息分析自动化程序，具备两大核心功能：1) PDF标题提取与文件重命名；2) 论文机构信息报告生成。程序可以递归遍历指定目录下的所有PDF文件，智能提取标题信息并重命名文件，同时能够基于目录结构分析论文的机构分布情况并生成标准化报告。

<img width="589" height="590" alt="image" src="https://github.com/user-attachments/assets/b0ee42e5-69fb-48d7-8a0b-cbbd1405f1f3" />

## 功能特性

### 1. PDF标题提取与重命名功能

#### 文件遍历与内容提取
- 支持递归遍历指定根目录下的所有子文件夹
- 识别并处理所有PDF文件，提取每个文件内容中的标题信息
- 实现多区域内容识别算法，对PDF文档的页眉、页脚、正文等不同区域进行智能分析
- 应用关键词匹配验证机制，提高标题提取的准确性
- 支持从元数据和文档内容两种方式提取标题信息
<img width="866" height="594" alt="image" src="https://github.com/user-attachments/assets/cc04bdac-dda9-495a-ae14-9ed9308a49a9" />

### 2. 文件重命名功能
- 使用提取到的标题对文件进行重命名，严格保留原始文件的.pdf扩展名
- 文件将直接以论文标题命名，不包含年份、作者等额外信息
- 设计了完善的重复标题处理策略，当检测到相同标题时自动添加序号（如"标题-1.pdf"、"标题-2.pdf"）
- 对无法提取标题的文件，提供双重命名方案：系统默认命名规则和用户自定义命名选项

### 3. 日志记录系统
- 生成详细的处理日志文件，包含以下信息：
  - 每个文件的处理状态（成功重命名、标题提取失败、文件跳过等）
  - 原始文件名和完整路径
  - 新文件名和完整路径
  - 精确的处理时间戳（精确到秒）
  - 错误详情（如适用）

### 4. 错误处理与容错机制
- 实现PDF文件完整性检查，能够识别并跳过损坏的PDF文件
- 对加密或受保护的PDF文件进行特殊处理，并在日志中明确标记
- 所有错误情况均在日志中详细记录错误类型和可能原因
- 程序支持优雅的异常捕获和处理，确保单一文件的错误不会影响整体处理

### 5. 数据汇总功能
- 将所有文件夹中的论文信息汇总到一个Excel表格中
- Excel表格包含以下字段：
  - 原始文件名
  - 新文件名
  - 文件所在文件夹路径
  - 提取到的标题
  - 文件名标题
  - 机构名称
  - 处理状态
  - 处理时间戳
<img width="1191" height="696" alt="image" src="https://github.com/user-attachments/assets/aa46365e-ec0e-4978-8537-b9d55e188594" />

### 2. 论文机构信息报告生成功能

#### 机构信息提取
- 从目录结构自动识别论文所属机构（基于文件夹名称）
- 根据机构特征识别细分子机构（论文出版社）
- 从PDF文件名中智能提取论文标题
- 支持多层级目录结构的识别与分析

#### 标准化报告生成
- 生成包含三列信息的Excel标准报告：论文所属机构、细分子机构、论文标题
- 自动格式化Excel表格，设置合适的列宽和标题样式
- 生成详细的机构分布统计报告，包含总体统计、机构分布和出版社分布
- 提供完整的数据处理日志，记录处理过程和结果

#### 智能数据处理
- 自动清理文件名中的干扰信息，提取准确的论文标题
- 根据机构名称和文件特征智能匹配出版社信息
- 支持特殊字符处理和文本规范化
- 提供详细的统计分析，包括数量和百分比分布

### 6. 灵活的配置选项
- 支持通过命令行参数进行灵活配置
- 可自定义日志级别，便于调试
- 提供默认配置和用户自定义配置选项

## 安装说明

### 1. 安装Python
确保你的系统已安装Python 3.7或更高版本。可以从[Python官网](https://www.python.org/downloads/)下载安装。

### 2. 安装依赖
使用以下命令安装程序所需的依赖库：

```bash
pip install -r requirements.txt
```

依赖库包括：
- PyPDF2: 用于PDF元数据提取
- pdfplumber: 用于PDF内容提取
- pandas: 用于数据处理和Excel报告生成
- openpyxl: 用于Excel文件写入

## 使用方法

### 1. PDF标题提取与重命名工具使用方法

最简单的使用方式是直接运行程序并指定要处理的文件夹：

```bash
python pdf_title_renamer.py [文件夹路径]
```

如果不提供文件夹路径，程序会提示你输入。

### 高级选项

程序支持多种命令行参数来自定义处理行为：

```bash
python pdf_title_renamer.py [文件夹路径] [选项]
```

可用选项：

- `-r`, `--recursive`: 递归处理所有子文件夹
- `-n`, `--custom-name`: 无法识别标题时使用的自定义命名前缀
- `--no-excel`: 不生成Excel汇总报告
- `--log-level`: 设置日志级别（可选值：DEBUG, INFO, WARNING, ERROR，默认：INFO）

### 使用示例

1. 基本使用（当前文件夹）：
   ```bash
   python pdf_title_renamer.py
   ```

2. 指定文件夹并递归处理：
   ```bash
   python pdf_title_renamer.py D:\pdfs -r
   ```

3. 使用自定义未知文件命名前缀：
   ```bash
   python pdf_title_renamer.py D:\pdfs --custom-name 未命名论文
   ```

4. 启用调试日志：
   ```bash
   python pdf_title_renamer.py D:\pdfs --log-level DEBUG
   ```

### 5. 禁用Excel报告生成：
   ```bash
   python pdf_title_renamer.py D:\pdfs --no-excel
   ```

### 2. 论文机构信息报告生成工具使用方法

#### 基本用法

直接运行机构信息报告生成工具，它会自动扫描当前目录下的所有机构文件夹：

```bash
python generate_paper_institution_report.py
```

#### 使用说明
- 工具会自动识别当前目录下的主要机构文件夹（如AAAI、Nature、中国知网等）
- 自动扫描所有PDF文件，提取论文标题和机构信息
- 生成标准化的Excel报告和文本格式的统计报告
- 所有输出文件自动保存在logs目录中

## 输出说明

### 1. PDF标题提取与重命名工具输出

#### 日志文件
处理日志将保存在程序所在目录下的`logs`文件夹中，文件名格式为`pdf_renamer_YYYYMMDD_HHMMSS.log`。

#### Excel报告
如果启用了Excel报告功能，报告文件将保存在`logs`文件夹中，文件名格式为`pdf_processing_report_YYYYMMDD_HHMMSS.xlsx`。

### 2. 论文机构信息报告生成工具输出

#### 日志文件
处理日志将保存在`logs`文件夹中，文件名格式为`paper_institution_report_YYYYMMDD_HHMMSS.log`。

#### Excel报告
标准化的论文机构信息Excel报告保存在`logs`文件夹中，文件名格式为`论文机构信息汇总_YYYYMMDD_HHMMSS.xlsx`。

#### 统计报告
详细的机构分布统计报告保存在`logs`文件夹中，文件名格式为`机构分布报告_YYYYMMDD_HHMMSS.txt`。

## 注意事项

1. 程序会自动跳过隐藏文件和系统文件（如Thumbs.db、desktop.ini等）。
2. 对于加密的PDF文件，程序会尝试使用空密码解密，如解密失败则会标记为加密文件。
3. 程序会确保文件名中不包含非法字符，以避免操作系统错误。
4. 处理大量文件时，可能需要较长时间，请耐心等待。

## 常见问题

### 问题：程序无法识别PDF标题

解决方案：
- 确保PDF文档格式标准，标题明显且位于文档首页
- 尝试使用更高的日志级别（DEBUG）查看详细处理过程
- 某些扫描版PDF可能无法提取文本信息，程序会使用默认命名

### 问题：程序无法处理某些PDF文件

解决方案：
- 检查文件是否加密，对于加密文件需要先解密
- 检查文件是否损坏，可以尝试用PDF阅读器打开验证

### 问题：生成的Excel报告无法打开

解决方案：
- 确保已正确安装openpyxl库
- 检查日志文件中的错误信息以获取详细原因

## 许可证

本项目仅供个人学习和使用，未经授权不得用于商业用途。

## 更新日志

### v2.0 (最新版本)
- 新增论文机构信息报告生成功能
- 实现基于目录结构的机构自动识别
- 支持三列标准信息（机构、细分子机构、论文标题）提取与报告生成
- 添加机构分布统计分析功能
- 优化文件处理和日志记录机制

### v1.0 (初始版本)
- 实现PDF标题提取和重命名功能
- 支持递归处理文件夹
- 实现Excel报告生成
- 添加完整的错误处理机制
- 支持命令行参数配置

